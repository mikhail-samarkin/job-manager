Job-manager
======================

Ветка with_repository отличается применением паттерна Реопозиторий к поставленной задаче

Структура проекта
-------------------

```
bootstrap/                  содержит настройки предзагрузки приоложения
common
    dto/                    содержит классы Data Transfer Object
    entities/               содержит классы связывающие с базой данных
    migrations              содержит миграции базы данных
    repositories/           содержит репозитории по работе с БД
    services/               содержит сервисы, используемые контроллерами
config/                     содержит настройки приложения
console/                    содержит контроллеры консольных комманд
environments/               содержит файлы для начальной инициализации приложения
modules
    api/                    модуль содержит end-point'ы HTTP API
tests/                      набор юнит тестов
web/                        содержит публичные файлы приложения
```

Консольные команды
-------------------

Первоначальная инициализация приложения
```
php initialization [environment] [overwrite]
    environment             не обязательное поле с значением "dev" по умолчанию
    overwrite               не обязательное поле с значением "y" по умолчанию
```

Генерирование случайных вакансий в количестве от 10 до 100
```
php yii vacancy/generate
```

Доступные API
-------------------

В данный момент доступна только первая версия (v1), использовано регулярное выражение <version:v\d+>
позволяющие в будущем использовать другие версии: v2, v3, v4 и т.д
По умолчанию вызывается версия v1

```
/api/vacancy/index          получить список всех вакансий в формате JSON
```

Не обязательный входной параметр - page. Лимит по умолчанию 10 записей.
Например вызов
```
/api/vacancy/index?page=2
```
вернет записи с 10 по 20, что соответствует второй странице


Запуск приложения
-------------------

Приложение поддерживает два вариант разворачивания: docker контейнер или ручной метод

Запуск в Docker контейнере
Для запуска контейнера используете команду
```
make install
```
При первом запуске будут запрошены данные для SSL сертификата, используйте значения по умолчанию
Помимо установки вебсервера и СУБД будет выполнена установка миграций и генерация тестовых данных

Либо используйте ручной метод

```
1. Выполнить команду php initialization
2. Заполнить файл config/serv.env данными о БД
3. Выполнить команду php yii migrate
4. Выполнить команду php yii vacancy/generate
```

Запуск тестов
-------------------


Для запуска тестов используйте Codeception
```
./vendor/bin/codecept run
```
или
```
make test
```